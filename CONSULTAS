1)
SELECT  p.COD_PROG, p.NOMBRE
FROM PROGRAMA p
WHERE NOT EXISTS (
 SELECT *
 FROM PROGRAMA p2, ESPACIO e
 WHERE p2.COD_PROG = P.COD_PROG AND p.COD_PROG = e.COD_PROG AND (e.DIA = 'DOM' OR e.DIA = 'SAB') )
 
 2)   
 SELECT DIA, COUNT(DIA) AS CANT_ANUNCIOS
FROM PUBLICIDAD p, ANUNCIO an, ANUNCIANTE at
WHERE p.TITULO = an.TITULO AND an.CUENTA = at.CUENTA AND at.RAZON_SOCIAL = 'Juan Uncio'
GROUP BY DIA
HAVING COUNT(DIA) = (   
     SELECT MAX(CANTIDAD_DIARIA)
     FROM (  
            SELECT  p.DIA, COUNT (*) AS CANTIDAD_DIARIA
            FROM PUBLICIDAD p, ANUNCIO an, ANUNCIANTE at
           WHERE p.TITULO = an.TITULO AND an.CUENTA = at.CUENTA AND at.RAZON_SOCIAL = 'Juan Uncio'
           GROUP BY p.DIA
     )
)
 
 
3) /* falta seleccionar el maximo */
SELECT razon_social, suma FROM anunciante,  (SELECT cuenta, count(*) suma  FROM (
           SELECT  DISTINCT anu.cuenta, esp.cod_prog FROM publicidad pub, anuncio anu, espacio esp
           WHERE pub.titulo = anu.titulo
           AND pub.dia = esp.dia
           AND pub.hora = esp.hora
      )
GROUP BY cuenta
) resultado
WHERE anunciante.cuenta = resultado.cuenta 
 

4)/**** La que mando sebastian al mail****/
SELECT findesemana.nombre, findesemana.promedio FROM
(SELECT pro.nombre, Sum(resultado.veces) / 5 AS promedio FROM programa pro, (
        SELECT esp.cod_prog, count(*) AS veces FROM espacio esp
        WHERE esp.cod_prog IN (SELECT cod_prog FROM produccion)
        AND (esp.dia!='DOM' AND esp.dia!='SAB')
        GROUP BY esp.dia, esp.cod_prog
        ORDER BY esp.cod_prog, esp.dia)  resultado
WHERE pro.cod_prog = resultado.cod_prog
GROUP BY pro.nombre) semana,
(SELECT pro.nombre, Sum(resultado.veces) / 2 AS promedio FROM programa pro, (
        SELECT esp.cod_prog, count(*) AS veces FROM espacio esp
        WHERE esp.cod_prog IN (SELECT cod_prog FROM produccion)
        AND (esp.dia='DOM' OR esp.dia='SAB')
        GROUP BY esp.dia, esp.cod_prog
        ORDER BY esp.cod_prog, esp.dia)  resultado
WHERE pro.cod_prog = resultado.cod_prog
GROUP BY pro.nombre) findesemana
WHERE semana.nombre = findesemana.nombre
AND findesemana.promedio > semana.promedio

 
 5) 

SELECT t.dia, t.hora, t.tanda
FROM 
(SELECT dia, hora, tanda, COUNT(*) AS cant_anuncios
FROM Publicidad 
GROUP BY dia, hora, tanda) t, 
 (SELECT DISTINCT dia, AVG(cant_dia) as prom_dia
FROM (SELECT dia, hora, tanda, COUNT(*) AS cant_dia
FROM Publicidad
GROUP BY dia, hora, tanda)
GROUP BY dia) r
WHERE t.dia = r.dia AND t.cant_anuncios > r.prom_dia

6)



SELECT dia, MAX (anun_distintos) AS max_dia
FROM
(SELECT e.dia, e.hora, COUNT(DISTINCT p.titulo) AS anun_distintos
FROM Espacio e, Publicidad p
WHERE e.dia = p.dia AND e.hora = p.hora
GROUP BY e.dia, e.hora)
GROUP BY dia

/* no me convence como esta hecho.. despues lo reviso .. el order by es para que se vea lindo el resultado */
SELECT es.dia, es.hora, pr.nombre, anun_distintos
FROM Espacio es, Programa pr, (SELECT e.dia, e.hora, COUNT(DISTINCT p.titulo) AS anun_distintos
FROM Espacio e, Publicidad p
WHERE e.dia = p.dia AND e.hora = p.hora
GROUP BY e.dia, e.hora) cant, (SELECT dia, MAX (anun_distintos) AS max_dia
FROM
(SELECT e.dia, e.hora, COUNT(DISTINCT p.titulo) AS anun_distintos
FROM Espacio e, Publicidad p
WHERE e.dia = p.dia AND e.hora = p.hora
GROUP BY e.dia, e.hora)
GROUP BY dia) total
WHERE es.cod_prog = pr.cod_prog AND cant.dia = es.dia AND cant.hora = es.hora AND cant.anun_distintos = total.max_dia AND total.dia = es.dia


order by es.dia


 
 7) 
select distinct p.nombre
from programa p, ocupacion o
where o.cod_prog=p.cod_prog
and not exists(select 'dias habiles' from espacio e where e.dia not in('SAB','DOM')
and not exists(select 'programa en vivo' from ocupacion oc,espacio e1 where oc.cod_prog=e1.cod_prog and e1.dia=e.dia and oc.cod_prog=o.cod_prog));

8)
select distinct e.dia
from espacio e
where not exists(select * from estudio est where not exists(select * from ocupacion oc, espacio e1 where oc.estudio=est.estudio and e1.cod_prog=oc.cod_prog and e1.dia=e.dia));


10)
/********Para debbugear o ver si es correcto, agregar p.cod_prog y asi es mas facil**********/
select distinct p.NOMBRE
from PROGRAMA p, ESPACIO e
where e.COD_PROG=p.COD_PROG
and not exists(select * from (select e1.DIA from ESPACIO e1 where  not exists(select * from MOVIL_EXTERIOR me where not exists(select * from UTILIZACION ut1,ESPACIO e2 where e2.COD_PROG=ut1.COD_PROG and ut1.MOVIL=me.MOVIL and e2.DIA=e1.DIA))) e4 where not exists(select * from espacio e3, programa p1 where e3.cod_prog=p1.cod_prog and e3.dia=e4.dia and p1.cod_prog=p.cod_prog));







